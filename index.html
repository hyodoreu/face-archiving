<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>find ğŸ§‘â€ğŸ¦²</title>
    <style>
        body { margin: 0; }
        .bg {
            width: 100vw;
            position: absolute;
            z-index: -10;
        }
        #webcam {
    position: absolute;
    top: 10%;
    left: 5%;
    width: 90vw;
    height: 80vh;
    object-fit: cover;
    z-index: -1;
    transform: scaleX(-1); /* ì¢Œìš° ë°˜ì „ */
    clip-path: polygon(0% 25px, 25px 0%, calc(100% - 25px) 0%, 100% 25px, 100% calc(100% - 25px), calc(100% - 25px) 100%, 25px 100%, 0% calc(100% - 25px)); /* ëª¨ì„œë¦¬ 25px ê°ì§€ê²Œ */}

        #logo {
            position: absolute;
            bottom: 2%;
            left: 50%;
            transform: translateX(-50%);
            cursor: pointer;
        }

        /* #E0FC61; */
        #screenshotPopup {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    display: none;
    flex-direction: column;
    align-items: center;
    background-color: #ffffff;
    padding: 30px;
    width: 340px;
    height: 400px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    z-index: 10;
    overflow: hidden; /* ì´ë¯¸ì§€ê°€ ë„˜ì¹˜ì§€ ì•Šë„ë¡ ì„¤ì • */
    clip-path: polygon(0% 10px, 10px 0%, calc(100% - 10px) 0%, 100% 10px, 100% calc(100% - 10px), calc(100% - 10px) 100%, 10px 100%, 0% calc(100% - 10px)); /* ëª¨ì„œë¦¬ 10px ê°ì§€ê²Œ */
}

#screenshotImage {
    margin-top: 20px;
    transform: scaleX(-1); 
    max-width: 100%;
    max-height: 100%;
    aspect-ratio: 3 / 3; /* ì¦ëª…ì‚¬ì§„ ë¹„ìœ¨ */
    object-fit: cover; /* ë¹„ìœ¨ ìœ ì§€í•˜ë©° ì˜ë¼ë‚´ê¸° */
}

        #randomImage {
            margin-top: 15px;
            height: 24px;
            z-index: 100;
            display: none;
        }
        #closeButton {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 30px;
            background: none;
            border: none;
            cursor: pointer;
            color: #E0FC61;
        }
        .gif {
            position: absolute;
            width: 12vw;
            cursor: pointer; /* í´ë¦­ ê°€ëŠ¥í•œ ìŠ¤íƒ€ì¼ ì¶”ê°€ */
        }
        .back{
            position: fixed;
            bottom: -60vh;
            width:150vw;
            z-index: -999;
        } #redLine {
    position: absolute;
    top: 0;
    left: 0;
    height: 90%;
    width: 3px;
    margin-top: 20px;
    background-color: #ff0000;
    animation: slideRight 2s ease forwards;
}

@keyframes slideRight {
    0% {
        left: 0;
        opacity: 1;
    }
    100% {
        left: 100%;
        opacity: 0;
    }
}
    </style>
</head>
<body>

    <video id="webcam" autoplay playsinline muted></video>
    <img id="logo" src="logo.png" alt="Logo" width="100">
    
    <img src="cx-side.gif" class="gif" style="bottom: 2vh; left: 14vw;">
    <img src="id-side.gif" class="gif" style="bottom: 4vh; left: 30vw;">
    <img src="ux-side.gif" class="gif" style="bottom: 2vh; right: 12vw;">
    <img src="ill-side.gif" class="gif" style="bottom: 0vh; right:0vw;">
    <img src="vi-side.gif" class="gif" style="bottom: 6vh; left: 0vw;">
    <img src="ed-side.gif" class="gif" style="bottom: 0vh; left: 60vw;">
    <img src="bg.png" class="back">
    
    <div id="screenshotPopup">
        <button id="closeButton">X</button>
        <div style="position: relative;">
            <img id="screenshotImage" alt="ìŠ¤í¬ë¦°ìƒ·">
            <div id="redLine"></div> <!-- ë¹¨ê°„ ì„  ì¶”ê°€ -->
        </div>
        <img id="randomImage" alt="ëœë¤ ì´ë¯¸ì§€">
    </div>

    <script>
        // IndexedDB ì´ˆê¸°í™”
        let db;

        const request = indexedDB.open('myDatabase', 1);

        request.onupgradeneeded = (event) => {
            db = event.target.result;
            db.createObjectStore('images', { keyPath: 'id' });
        };

        request.onsuccess = (event) => {
            db = event.target.result;
            console.log('ë°ì´í„°ë² ì´ìŠ¤ ì—´ê¸° ì„±ê³µ');
        };

        request.onerror = (event) => {
            console.error('ë°ì´í„°ë² ì´ìŠ¤ ì—´ê¸° ì‹¤íŒ¨:', event);
        };

        // ì›¹ìº  ìŠ¤íŠ¸ë¦¬ë° ì„¤ì •
        const video = document.getElementById('webcam');
        navigator.mediaDevices.getUserMedia({ video: true })
            .then(stream => { video.srcObject = stream; })
            .catch(err => console.error('ì›¹ìº  ì ‘ê·¼ ë¶ˆê°€:', err));

        // ì´ë¯¸ì§€ ì €ì¥ í•¨ìˆ˜
        function saveImage(screenshotSrc, randomImgSrc) {
            const transaction = db.transaction(['images'], 'readwrite');
            const objectStore = transaction.objectStore('images');

            const imageData = {
                id: Date.now(),
                screenshot: screenshotSrc,
                random: randomImgSrc
            };

            const request = objectStore.add(imageData);

            request.onsuccess = () => {
                console.log('ì´ë¯¸ì§€ ì €ì¥ ì„±ê³µ:', imageData);
            };

            request.onerror = (event) => {
                console.error('ì´ë¯¸ì§€ ì €ì¥ ì‹¤íŒ¨:', event);
            };
        }

        // ë¡œê³  í´ë¦­ ì´ë²¤íŠ¸
        logo.addEventListener('click', () => {
    const canvas = document.createElement('canvas');
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;
    canvas.getContext('2d').drawImage(video, 0, 0);
    const screenshotSrc = canvas.toDataURL('image/png');

    const images = ['1.png', '2.png', '3.png', '4.png', '5.png', '6.png', '7.png', '8.png', '10.png', 
        '11.png', '12.png', '13.png', '14.png', '15.png', '16.png', '17.png', '18.png', 
        '19.png', '20.png', '21.png', '22.png', '23.png', '24.png', '25.png', '26.png', 
        '27.png', '29.png', '30.png', '31.png', '32.png', '33.png', '34.png', 
        '35.png', '36.png', '37.png'];
    const randomImgSrc = images[Math.floor(Math.random() * images.length)];

    screenshotImage.src = screenshotSrc;
    randomImage.src = randomImgSrc;

    screenshotPopup.style.display = 'flex';
    screenshotImage.style.opacity = '0'; // ì²˜ìŒì— opacity 0ìœ¼ë¡œ ì„¤ì •
    randomImage.style.display = 'none'; // ëœë¤ ì´ë¯¸ì§€ë¥¼ ìˆ¨ê¹€

    // 3ì´ˆ í›„ì— randomImageë¥¼ í‘œì‹œí•˜ê³  screenshotImageì˜ opacityë¥¼ 1ë¡œ ë³€ê²½
    setTimeout(() => {
        randomImage.style.display = 'block';  // randomImageë¥¼ ë³´ì´ë„ë¡ ì„¤ì •
        screenshotImage.style.opacity = '1';  // 0.3ì´ˆ í›„ì— opacityë¥¼ 1ë¡œ ë³€ê²½
    }, 2000); // 3ì´ˆ í›„ì—

    saveImage(screenshotSrc, randomImgSrc);
});
        screenshotImage.onload = () => {
        // #screenshotImageì˜ ë†’ì´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ #redLineì˜ ë†’ì´ë¥¼ ì¡°ì •
        const screenshotHeight = screenshotImage.offsetHeight;
        redLine.style.height = `${screenshotHeight * 1}px`; // 90% ë†’ì´ë¡œ ì„¤ì •
    };
        // íŒì—… ë‹«ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸
        closeButton.addEventListener('click', () => {
            screenshotPopup.style.display = 'none';
        });

        // .gif í´ë¦­ ì‹œ archive.index í˜ì´ì§€ë¡œ ì´ë™
        document.querySelectorAll('.gif').forEach(gif => {
            gif.addEventListener('click', () => {
                window.open('archive.html', '_blank'); // ìƒˆ íƒ­ì—ì„œ í˜ì´ì§€ ì—´ê¸°
            });
        });
    </script>
</body>
</html>
